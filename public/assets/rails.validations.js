(function(){var e,t,i,n,a=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1};e=jQuery,e.fn.disableClientSideValidations=function(){return ClientSideValidations.disable(this),this},e.fn.enableClientSideValidations=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return ClientSideValidations.enablers.form(this)}),this.filter(ClientSideValidations.selectors.inputs).each(function(){return ClientSideValidations.enablers.input(this)}),this},e.fn.resetClientSideValidations=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return ClientSideValidations.reset(this)}),this},e.fn.validate=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return e(this).enableClientSideValidations()}),this},e.fn.isValid=function(a){var s;return s=e(this[0]),s.is("form")?i(s,a):t(s,n(this[0].name,a))},n=function(e,t){return e=e.replace(/_attributes\]\[\w+\]\[(\w+)\]/g,"_attributes][][$1]"),t[e]||{}},i=function(t,i){var n;return t.trigger("form:validate:before.ClientSideValidations"),n=!0,t.find(ClientSideValidations.selectors.validate_inputs).each(function(){return e(this).isValid(i)||(n=!1),!0}),t.trigger(n?"form:validate:pass.ClientSideValidations":"form:validate:fail.ClientSideValidations"),t.trigger("form:validate:after.ClientSideValidations"),n},t=function(t,i){var n,a,s,r,o,l,c;return t.trigger("element:validate:before.ClientSideValidations"),l=function(){return t.trigger("element:validate:pass.ClientSideValidations").data("valid",null)},r=function(e){return t.trigger("element:validate:fail.ClientSideValidations",e).data("valid",!1),!1},n=function(){return t.trigger("element:validate:after.ClientSideValidations").data("valid")!==!1},s=function(e){var n,a,s,o,l,c,u,d;o=!0;for(a in e)if(n=e[a],i[a]){for(d=i[a],c=0,u=d.length;u>c;c++)if(l=d[c],s=n.call(e,t,l)){o=r(s);break}if(!o)break}return o},a=t.attr("name").replace(/\[([^\]]*?)\]$/,"[_destroy]"),"1"===e("input[name='"+a+"']").val()?(l(),n()):t.data("changed")===!1?n():(t.data("changed",!1),o=ClientSideValidations.validators.local,c=ClientSideValidations.validators.remote,s(o)&&s(c)&&l(),n())},void 0===window.ClientSideValidations&&(window.ClientSideValidations={}),void 0===window.ClientSideValidations.forms&&(window.ClientSideValidations.forms={}),window.ClientSideValidations.selectors={inputs:':input:not(button):not([type="submit"])[name]:visible:enabled',validate_inputs:":input:enabled:visible[data-validate]",forms:"form[data-validate]"},window.ClientSideValidations.reset=function(t){var i,n;i=e(t),ClientSideValidations.disable(t);for(n in t.ClientSideValidations.settings.validators)t.ClientSideValidations.removeError(i.find("[name='"+n+"']"));return ClientSideValidations.enablers.form(t)},window.ClientSideValidations.disable=function(t){var i;return i=e(t),i.off(".ClientSideValidations"),i.is("form")?ClientSideValidations.disable(i.find(":input")):(i.removeData("valid"),i.removeData("changed"),i.filter(":input").each(function(){return e(this).removeAttr("data-validate")}))},window.ClientSideValidations.enablers={form:function(t){var i,n,a,s;i=e(t),t.ClientSideValidations={settings:window.ClientSideValidations.forms[i.attr("id")],addError:function(e,i){return ClientSideValidations.formBuilders[t.ClientSideValidations.settings.type].add(e,t.ClientSideValidations.settings,i)},removeError:function(e){return ClientSideValidations.formBuilders[t.ClientSideValidations.settings.type].remove(e,t.ClientSideValidations.settings)}},s={"submit.ClientSideValidations":function(e){return i.isValid(t.ClientSideValidations.settings.validators)?void 0:(e.preventDefault(),e.stopImmediatePropagation())},"ajax:beforeSend.ClientSideValidations":function(e){return e.target===this?i.isValid(t.ClientSideValidations.settings.validators):void 0},"form:validate:after.ClientSideValidations":function(e){return ClientSideValidations.callbacks.form.after(i,e)},"form:validate:before.ClientSideValidations":function(e){return ClientSideValidations.callbacks.form.before(i,e)},"form:validate:fail.ClientSideValidations":function(e){return ClientSideValidations.callbacks.form.fail(i,e)},"form:validate:pass.ClientSideValidations":function(e){return ClientSideValidations.callbacks.form.pass(i,e)}};for(a in s)n=s[a],i.on(a,n);return i.find(ClientSideValidations.selectors.inputs).each(function(){return ClientSideValidations.enablers.input(this)})},input:function(t){var i,n,a,s,r,o;n=e(t),r=t.form,i=e(r),o={"focusout.ClientSideValidations":function(){return e(this).isValid(r.ClientSideValidations.settings.validators)},"change.ClientSideValidations":function(){return e(this).data("changed",!0)},"element:validate:after.ClientSideValidations":function(t){return ClientSideValidations.callbacks.element.after(e(this),t)},"element:validate:before.ClientSideValidations":function(t){return ClientSideValidations.callbacks.element.before(e(this),t)},"element:validate:fail.ClientSideValidations":function(t,i){var n;return n=e(this),ClientSideValidations.callbacks.element.fail(n,i,function(){return r.ClientSideValidations.addError(n,i)},t)},"element:validate:pass.ClientSideValidations":function(t){var i;return i=e(this),ClientSideValidations.callbacks.element.pass(i,function(){return r.ClientSideValidations.removeError(i)},t)}};for(s in o)a=o[s],n.filter(":not(:radio):not([id$=_confirmation])").each(function(){return e(this).attr("data-validate",!0)}).on(s,a);return n.filter(":checkbox").on("click.ClientSideValidations",function(){return e(this).isValid(r.ClientSideValidations.settings.validators),!0}),n.filter("[id$=_confirmation]").each(function(){var t,n,o,l;if(t=e(this),n=i.find("#"+this.id.match(/(.+)_confirmation/)[1]+":input"),n[0]){o={"focusout.ClientSideValidations":function(){return n.data("changed",!0).isValid(r.ClientSideValidations.settings.validators)},"keyup.ClientSideValidations":function(){return n.data("changed",!0).isValid(r.ClientSideValidations.settings.validators)}},l=[];for(s in o)a=o[s],l.push(e("#"+t.attr("id")).on(s,a));return l}})}},window.ClientSideValidations.validators={all:function(){return jQuery.extend({},ClientSideValidations.validators.local,ClientSideValidations.validators.remote)},local:{presence:function(e,t){return/^\s*$/.test(e.val()||"")?t.message:void 0},acceptance:function(e,t){var i;switch(e.attr("type")){case"checkbox":if(!e.prop("checked"))return t.message;break;case"text":if(e.val()!==((null!=(i=t.accept)?i.toString():void 0)||"1"))return t.message}},format:function(e,t){var i;if(i=this.presence(e,t)){if(t.allow_blank===!0)return;return i}return t["with"]&&!t["with"].test(e.val())?t.message:t.without&&t.without.test(e.val())?t.message:void 0},numericality:function(t,i){var n,a,s,r,o,l,c;if(c=jQuery.trim(t.val()),!ClientSideValidations.patterns.numericality.test(c)){if(i.allow_blank===!0&&this.presence(t,{message:i.messages.numericality}))return;return i.messages.numericality}if(c=c.replace(new RegExp("\\"+ClientSideValidations.number_format.delimiter,"g"),"").replace(new RegExp("\\"+ClientSideValidations.number_format.separator,"g"),"."),i.only_integer&&!/^[+-]?\d+$/.test(c))return i.messages.only_integer;n={greater_than:">",greater_than_or_equal_to:">=",equal_to:"==",less_than:"<",less_than_or_equal_to:"<="},o=e(t[0].form);for(a in n)if(l=n[a],null!=i[a]){if(!isNaN(parseFloat(i[a]))&&isFinite(i[a]))s=i[a];else{if(1!==o.find("[name*="+i[a]+"]").size())return;s=o.find("[name*="+i[a]+"]").val()}if(r=new Function("return "+c+" "+l+" "+s),!r())return i.messages[a]}return!i.odd||parseInt(c,10)%2?i.even&&parseInt(c,10)%2?i.messages.even:void 0:i.messages.odd},length:function(e,t){var i,n,a,s,r,o,l,c;if(c=t.js_tokenizer||"split('')",l=new Function("element","return (element.val()."+c+" || '').length")(e),i={is:"==",minimum:">=",maximum:"<="},n={},n.message=t.is?t.messages.is:t.minimum?t.messages.minimum:void 0,r=this.presence(e,n)){if(t.allow_blank===!0)return;return r}for(a in i)if(o=i[a],t[a]&&(s=new Function("return "+l+" "+o+" "+t[a]),!s()))return t.messages[a]},exclusion:function(e,t){var i,n,s,r,o;if(n=this.presence(e,t)){if(t.allow_blank===!0)return;return n}return t["in"]&&(o=e.val(),a.call(function(){var e,i,n,a;for(n=t["in"],a=[],e=0,i=n.length;i>e;e++)s=n[e],a.push(s.toString());return a}(),o)>=0)?t.message:t.range&&(i=t.range[0],r=t.range[1],e.val()>=i&&e.val()<=r)?t.message:void 0},inclusion:function(e,t){var i,n,s,r,o;if(n=this.presence(e,t)){if(t.allow_blank===!0)return;return n}if(t["in"]){if(o=e.val(),a.call(function(){var e,i,n,a;for(n=t["in"],a=[],e=0,i=n.length;i>e;e++)s=n[e],a.push(s.toString());return a}(),o)>=0)return;return t.message}if(t.range){if(i=t.range[0],r=t.range[1],e.val()>=i&&e.val()<=r)return;return t.message}},confirmation:function(e,t){return e.val()!==jQuery("#"+e.attr("id")+"_confirmation").val()?t.message:void 0},uniqueness:function(t,i){var n,a,s,r,o,l,c;return s=t.attr("name"),/_attributes\]\[\d/.test(s)&&(a=s.match(/^(.+_attributes\])\[\d+\](.+)$/),r=a[1],o=a[2],c=t.val(),r&&o&&(n=t.closest("form"),l=!0,n.find(':input[name^="'+r+'"][name$="'+o+'"]').each(function(){if(e(this).attr("name")!==s){if(e(this).val()===c)return l=!1,e(this).data("notLocallyUnique",!0);if(e(this).data("notLocallyUnique"))return e(this).removeData("notLocallyUnique").data("changed",!0)}}),!l))?i.message:void 0}},remote:{uniqueness:function(e,t){var i,n,a,s,r,o,l,c;if(a=ClientSideValidations.validators.local.presence(e,t)){if(t.allow_blank===!0)return;return a}if(i={},i.case_sensitive=!!t.case_sensitive,t.id&&(i.id=t.id),t.scope){i.scope={},c=t.scope;for(n in c)r=c[n],l=e.attr("name").replace(/\[\w+\]$/,"["+n+"]"),o=jQuery("[name='"+l+"']"),jQuery("[name='"+l+"']:checkbox").each(function(){return this.checked?o=this:void 0}),o[0]&&o.val()!==r?(i.scope[n]=o.val(),o.unbind("change."+e.id).bind("change."+e.id,function(){return e.trigger("change.ClientSideValidations"),e.trigger("focusout.ClientSideValidations")})):i.scope[n]=r}return/_attributes\]/.test(e.attr("name"))?(s=e.attr("name").match(/\[\w+_attributes\]/g).pop().match(/\[(\w+)_attributes\]/).pop(),s+=/(\[\w+\])$/.exec(e.attr("name"))[1]):s=e.attr("name"),t["class"]&&(s=t["class"]+"["+s.split("[")[1]),i[s]=e.val(),200===jQuery.ajax({url:ClientSideValidations.remote_validators_url_for("uniqueness"),data:i,async:!1,cache:!1}).status?t.message:void 0}}},window.ClientSideValidations.remote_validators_url_for=function(e){return null!=ClientSideValidations.remote_validators_prefix?"//"+window.location.host+ClientSideValidations.remote_validators_prefix+"/validators/"+e:"//"+window.location.host+"/validators/"+e},window.ClientSideValidations.disableValidators=function(){var e,t,i,n;if(void 0!==window.ClientSideValidations.disabled_validators){i=window.ClientSideValidations.validators.remote,n=[];for(t in i)e=i[t],n.push(-1!==window.ClientSideValidations.disabled_validators.indexOf(t)?delete window.ClientSideValidations.validators.remote[t]:void 0);return n}},window.ClientSideValidations.formBuilders={"ActionView::Helpers::FormBuilder":{add:function(t,i,n){var a,s,r,o;return a=e(t[0].form),t.data("valid")!==!1&&null==a.find("label.message[for='"+t.attr("id")+"']")[0]&&(s=jQuery(i.input_tag),o=jQuery(i.label_tag),r=a.find("label[for='"+t.attr("id")+"']:not(.message)"),t.attr("autofocus")&&t.attr("autofocus",!1),t.before(s),s.find("span#input_tag").replaceWith(t),s.find("label.message").attr("for",t.attr("id")),o.find("label.message").attr("for",t.attr("id")),o.insertAfter(r),o.find("label#label_tag").replaceWith(r)),a.find("label.message[for='"+t.attr("id")+"']").text(n)},remove:function(t,i){var n,a,s,r,o;return a=e(t[0].form),n=jQuery(i.input_tag).attr("class"),s=t.closest("."+n.replace(" ",".")),r=a.find("label[for='"+t.attr("id")+"']:not(.message)"),o=r.closest("."+n),s[0]?(s.find("#"+t.attr("id")).detach(),s.replaceWith(t),r.detach(),o.replaceWith(r)):void 0}}},window.ClientSideValidations.patterns={numericality:/^(-|\+)?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d*)?$/},window.ClientSideValidations.callbacks={element:{after:function(){},before:function(){},fail:function(e,t,i){return i()},pass:function(e,t){return t()}},form:{after:function(){},before:function(){},fail:function(){},pass:function(){}}},e(function(){return ClientSideValidations.disableValidators(),e(ClientSideValidations.selectors.forms).validate()})}).call(this);