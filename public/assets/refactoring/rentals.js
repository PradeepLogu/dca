(function(){this.module("Dchq",function(){return this.module("Rentals",function(){return this.module("Index",function(){return this.init=function(){return $("#create-rental-overlay").on("hidden.bs.modal",function(){return $(this).find("form")[0].reset(),$(this).find(".error-list").empty()}),$("#rental_customer_id").on("select2-open",function(){return $(".select2-drop.select2-display-none.select2-with-searchbox.select2-drop-active").css("z-index","10001")}),$("#create-rental-overlay form").on("submit",function(e){var t;return e.preventDefault(),t=$(this),$.ajax({type:"POST",url:t.attr("action"),data:t.serialize(),dataType:"json",success:function(e){return window.location.href="/rentals/"+e.id+"/edit"},error:function(e){return $("#create-rental-overlay .error-list").html($.tmpl("templates/errors",{data:$.parseJSON(e.responseText)}))}})})}}),this.module("Form",function(){var e;return this.init=function(){return Dchq.Rentals.Form.autocomplete(),Dchq.Rentals.Form.rental_products_in_lookup(),$("form.edit_rental select:not([class=selectpicker]), form.edit_rental .shop-client-products input[type=text]").live("change",function(){return $("form.edit_rental").submit()}),$("#add-payment-modal").on("hidden.bs.modal",function(){return $(this).find("input[type=number").val("")}),$("#search_rental_product").live("keypress",function(e){return 13===e.keyCode?(e.preventDefault(),$.post(Routes.add_rental_product_rental_path($("#search_rental_product").data("rental-id"),{barcode:$(this).val()}))):void 0})},this.autocomplete=function(){return $("#search_rental_product").autocomplete({minLength:2,select:function(e,t){return $.post(Routes.add_rental_product_rental_path($("#search_rental_product").data("rental-id"),{rental_product_id:t.item.id}))},source:function(e,t){$.ajax({url:Routes.search_rental_products_path(),dataType:"json",data:{term:e.term,rental_id:$("#search_rental_product").data("rental-id")},success:function(e){t(e)}})}})},this.rental_products_in_lookup=function(){return $("a.rental-product-lookup").live("click",function(){return $("#product_lookup #products").hide(),$.get("/brands.json",function(e){return $("#product-lookup-modal #brands").fill_in_selector(e)}),$.get("/categories.json",function(e){return $("#product-lookup-modal #categories").fill_in_selector(e)})}),$("#product-lookup-modal #brands a").live("click",function(){return e(this)}),$("#product-lookup-modal #categories a").live("click",function(){return e(this)}),$("#product-lookup-modal #products a").live("click",function(){return $.post(Routes.add_rental_product_rental_path($("#search_rental_product").data("rental-id"),{rental_product_id:$(this).data("id")})),$("#product-lookup-modal").modal("hide")})},e=function(e){return $.get(["",$(e).closest("div").attr("id"),$(e).attr("data-id")].join("/")+".json?type=rental",function(e){return $("#product-lookup-modal #brands").hide(),$("#product-lookup-modal #categories").hide(),$("#product-lookup-modal #products").fill_in_selector(e).show()})}}),this.module("Show",function(){return this.init=function(){return $("a.print-receipt").live("click",function(e){return e.preventDefault(),$("#print").printElement()})}})})}),$(function(){return $("body#rentals-index").length&&Dchq.Rentals.Index.init(),$("body#rentals-edit").length&&Dchq.Rentals.Form.init(),$("body#rentals-show").length?Dchq.Rentals.Show.init():void 0})}).call(this);