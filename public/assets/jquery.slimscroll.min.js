/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.0.9
 *
 */
!function(e){jQuery.fn.extend({slimScroll:function(t){var i=e.extend({wheelStep:20,width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:"0.2",railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,scroll:0,touchScrollStep:200},t);return this.each(function(){function n(e,t,n){var a=e,o=v.outerHeight()-_.outerHeight();t&&(a=parseInt(_.css("top"))+e*parseInt(i.wheelStep)/100*_.outerHeight(),a=Math.min(Math.max(a,0),o),a=e>0?Math.ceil(a):Math.floor(a),_.css({top:a+"px"})),p=parseInt(_.css("top"))/(v.outerHeight()-_.outerHeight()),a=p*(v[0].scrollHeight-v.outerHeight()),n&&(a=e,e=a/v[0].scrollHeight*v.outerHeight(),e=Math.min(Math.max(e,0),o),_.css({top:e+"px"})),v.scrollTop(a),s(),r()}function a(){d=Math.max(v.outerHeight()/v[0].scrollHeight*v.outerHeight(),m),_.css({height:d+"px"})}function s(){a(),clearTimeout(u),p==~~p&&(g=i.allowPageScroll,f!=p&&v.trigger("slimscroll",0==~~p?"top":"bottom")),f=p,d>=v.outerHeight()?g=!0:(_.stop(!0,!0).fadeIn("fast"),i.railVisible&&y.stop(!0,!0).fadeIn("fast"))}function r(){i.alwaysVisible||(u=setTimeout(function(){i.disableFadeOut&&o||l||c||(_.fadeOut("slow"),y.fadeOut("slow"))},1e3))}var o,l,c,u,h,d,p,f,m=30,g=!1,v=e(this);if(v.parent().hasClass("slimScrollDiv")){var b=v.scrollTop(),_=v.parent().find(".slimScrollBar"),y=v.parent().find(".slimScrollRail");if(a(),t){if("scrollTo"in t)b=parseInt(i.scrollTo);else if("scrollBy"in t)b+=parseInt(i.scrollBy);else if("destroy"in t)return _.remove(),y.remove(),void v.unwrap();n(b,!1,!0)}}else{i.height="auto"==i.height?v.parent().innerHeight():i.height,b=e("<div></div>").addClass(i.wrapperClass).css({position:"relative",overflow:"hidden",width:i.width,height:i.height}),v.css({overflow:"hidden",width:i.width,height:i.height});var y=e("<div></div>").addClass(i.railClass).css({width:i.size,height:"100%",position:"absolute",top:0,display:i.alwaysVisible&&i.railVisible?"block":"none","border-radius":i.size,background:i.railColor,opacity:i.railOpacity,zIndex:90}),_=e("<div></div>").addClass(i.barClass).css({background:i.color,width:i.size,position:"absolute",top:0,opacity:i.opacity,display:i.alwaysVisible?"block":"none","border-radius":i.size,BorderRadius:i.size,MozBorderRadius:i.size,WebkitBorderRadius:i.size,zIndex:99}),w="right"==i.position?{right:i.distance}:{left:i.distance};y.css(w),_.css(w),v.wrap(b),v.parent().append(_),v.parent().append(y),_.draggable({axis:"y",containment:"parent",start:function(){c=!0},stop:function(){c=!1,r()},drag:function(){n(0,e(this).position().top,!1)}}),y.hover(function(){s()},function(){r()}),_.hover(function(){l=!0},function(){l=!1}),v.hover(function(){o=!0,s(),r()},function(){o=!1,r()}),v.bind("touchstart",function(e){e.originalEvent.touches.length&&(h=e.originalEvent.touches[0].pageY)}),v.bind("touchmove",function(e){e.originalEvent.preventDefault(),e.originalEvent.touches.length&&n((h-e.originalEvent.touches[0].pageY)/i.touchScrollStep,!0)});var k=function(t){if(o){t=t||window.event;var a=0;t.wheelDelta&&(a=-t.wheelDelta/120),t.detail&&(a=t.detail/3),e(t.target||t.srcTarget).closest("."+i.wrapperClass).is(v.parent())&&n(a,!0),t.preventDefault&&!g&&t.preventDefault(),g||(t.returnValue=!1)}};!function(){window.addEventListener?(this.addEventListener("DOMMouseScroll",k,!1),this.addEventListener("mousewheel",k,!1)):document.attachEvent("onmousewheel",k)}(),a(),"bottom"==i.start?(_.css({top:v.outerHeight()-_.outerHeight()}),n(0,!0)):"object"==typeof i.start&&(n(e(i.start).position().top,null,!0),i.alwaysVisible||_.hide())}}),this}}),jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})}(jQuery);