/* ===========================================================
 * bootstrap-inputmask.js j2
 * http://twitter.github.com/bootstrap/javascript.html#tooltips
 * Based on Masked Input plugin by Josh Bush (digitalbush.com)
 * ===========================================================
 * Copyright 2012 Jasny BV, Netherlands.
 *
 * Licensed under the Apache License, Version 2.0 (the "License")
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */
!function(e){"use strict";var t=void 0!==window.orientation,i=navigator.userAgent.toLowerCase().indexOf("android")>-1;e.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","?":"[A-Za-z0-9]","*":"."},dataName:"rawMaskFn"};var n=function(t,n){i||(this.$element=e(t),this.mask=String(n.mask),this.options=e.extend({},e.fn.inputmask.defaults,n),this.init(),this.listen(),this.checkVal())};n.prototype={init:function(){var t=e.mask.definitions,i=this.mask.length;this.tests=[],this.partialPosition=this.mask.length,this.firstNonMaskPos=null,e.each(this.mask.split(""),e.proxy(function(e,n){"?"==n?(i--,this.partialPosition=e):t[n]?(this.tests.push(new RegExp(t[n])),null===this.firstNonMaskPos&&(this.firstNonMaskPos=this.tests.length-1)):this.tests.push(null)},this)),this.buffer=e.map(this.mask.split(""),e.proxy(function(e){return"?"!=e?t[e]?this.options.placeholder:e:void 0},this)),this.focusText=this.$element.val(),this.$element.data(e.mask.dataName,e.proxy(function(){return e.map(this.buffer,function(e,t){return this.tests[t]&&e!=this.options.placeholder?e:null}).join("")},this))},listen:function(){if(!this.$element.attr("readonly")){var t=(e.browser.msie?"paste":"input")+".mask";this.$element.on("unmask",e.proxy(this.unmask,this)).on("focus.mask",e.proxy(this.focusEvent,this)).on("blur.mask",e.proxy(this.blurEvent,this)).on("keydown.mask",e.proxy(this.keydownEvent,this)).on("keypress.mask",e.proxy(this.keypressEvent,this)).on(t,e.proxy(this.pasteEvent,this))}},caret:function(e,t){if(0!==this.$element.length){if("number"==typeof e)return t="number"==typeof t?t:e,this.$element.each(function(){if(this.setSelectionRange)this.setSelectionRange(e,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",e),i.select()}});if(this.$element[0].setSelectionRange)e=this.$element[0].selectionStart,t=this.$element[0].selectionEnd;else if(document.selection&&document.selection.createRange){var i=document.selection.createRange();e=0-i.duplicate().moveStart("character",-1e5),t=e+i.text.length}return{begin:e,end:t}}},seekNext:function(e){for(var t=this.mask.length;++e<=t&&!this.tests[e];);return e},seekPrev:function(e){for(;--e>=0&&!this.tests[e];);return e},shiftL:function(e,t){var i=this.mask.length;if(!(0>e)){for(var n=e,a=this.seekNext(t);i>n;n++)if(this.tests[n]){if(!(i>a&&this.tests[n].test(this.buffer[a])))break;this.buffer[n]=this.buffer[a],this.buffer[a]=this.options.placeholder,a=this.seekNext(a)}this.writeBuffer(),this.caret(Math.max(this.firstNonMaskPos,e))}},shiftR:function(e){for(var t=this.mask.length,i=e,n=this.options.placeholder;t>i;i++)if(this.tests[i]){var a=this.seekNext(i),s=this.buffer[i];if(this.buffer[i]=n,!(t>a&&this.tests[a].test(s)))break;n=s}},unmask:function(){this.$element.unbind(".mask").removeData("inputmask")},focusEvent:function(){this.focusText=this.$element.val();var t=this.mask.length,i=this.checkVal();this.writeBuffer();var n=this,a=function(){i==t?n.caret(0,i):n.caret(i)};e.browser.msie?a():setTimeout(a,0)},blurEvent:function(){this.checkVal(),this.$element.val()!=this.focusText&&this.$element.trigger("change")},keydownEvent:function(e){var i=e.which;if(8==i||46==i||t&&127==i){var n=this.caret(),a=n.begin,s=n.end;return s-a===0&&(a=46!=i?this.seekPrev(a):s=this.seekNext(a-1),s=46==i?this.seekNext(s):s),this.clearBuffer(a,s),this.shiftL(a,s-1),!1}return 27==i?(this.$element.val(this.focusText),this.caret(0,this.checkVal()),!1):void 0},keypressEvent:function(e){var t=this.mask.length,i=e.which,n=this.caret();if(e.ctrlKey||e.altKey||e.metaKey||32>i)return!0;if(i){n.end-n.begin!==0&&(this.clearBuffer(n.begin,n.end),this.shiftL(n.begin,n.end-1));var a=this.seekNext(n.begin-1);if(t>a){var s=String.fromCharCode(i);if(this.tests[a].test(s)){this.shiftR(a),this.buffer[a]=s,this.writeBuffer();var r=this.seekNext(a);this.caret(r)}}return!1}},pasteEvent:function(){var e=this;setTimeout(function(){e.caret(e.checkVal(!0))},0)},clearBuffer:function(e,t){for(var i=this.mask.length,n=e;t>n&&i>n;n++)this.tests[n]&&(this.buffer[n]=this.options.placeholder)},writeBuffer:function(){return this.$element.val(this.buffer.join("")).val()},checkVal:function(e){for(var t=this.mask.length,i=this.$element.val(),n=-1,a=0,s=0;t>a;a++)if(this.tests[a]){for(this.buffer[a]=this.options.placeholder;s++<i.length;){var r=i.charAt(s-1);if(this.tests[a].test(r)){this.buffer[a]=r,n=a;break}}if(s>i.length)break}else this.buffer[a]==i.charAt(s)&&a!=this.partialPosition&&(s++,n=a);return!e&&n+1<this.partialPosition?(this.$element.val(""),this.clearBuffer(0,t)):(e||n+1>=this.partialPosition)&&(this.writeBuffer(),e||this.$element.val(this.$element.val().substring(0,n+1))),this.partialPosition?a:this.firstNonMaskPos}},e.fn.inputmask=function(t){return this.each(function(){var i=e(this),a=i.data("inputmask");a||i.data("inputmask",a=new n(this,t))})},e.fn.inputmask.defaults={placeholder:"_"},e.fn.inputmask.Constructor=n,e(function(){e("body").on("focus.inputmask.data-api","[data-mask]",function(t){var i=e(this);i.data("inputmask")||(t.preventDefault(),i.inputmask(i.data()))})})}(window.jQuery);