!function(e){function t(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0}function n(e,t){return e[0]>t[0]?-1:e[0]<t[0]?1:0}{var a=new Array;new Array}e.fn.jqBarGraph=e.fn.jqbargraph=function(s){init=function(t){a[t.id]=e.extend({},e.fn.jqBarGraph.defaults,s),e(t).css({width:a[t.id].width,height:a[t.id].height,position:"relative","text-align":"center"}),doGraph(t)},sum=function(e){total=0;for(val in e)total+=e[val];return total.toFixed(2)},max=function(e){maxvalue=0;for(var t in e)value=e[t][0],value instanceof Array&&(value=sum(value)),parseFloat(value)>parseFloat(maxvalue)&&(maxvalue=value);return maxvalue},maxMulti=function(e){maxvalue=0,maxvalue2=0;for(var t in e){ar2=e[t][0];for(var i in ar2)ar2[i]>maxvalue2&&(maxvalue2=ar2[i]);maxvalue2>maxvalue&&(maxvalue=maxvalue2)}return maxvalue},doGraph=function(s){if(arr=a[s.id],data=arr.data,void 0==data)return void e(s).html("There is not enought data for graph");"asc"==arr.sort&&data.sort(t),"desc"==arr.sort&&data.sort(n),legend="",prefix=arr.prefix,postfix=arr.postfix,space=arr.barSpace,legendWidth=arr.legend?arr.legendWidth:0,fieldWidth=(e(s).width()-legendWidth)/data.length,totalHeight=e(s).height();var r=new Array;max=max(data),colPosition=0;for(var l in data){if(valueData=data[l][0],value=valueData instanceof Array?sum(valueData):valueData,lbl=data[l][1],color=data[l][2],unique=l+s.id,void 0==color&&0==arr.colors&&(color=arr.color),arr.colors&&!color&&(colorsCounter=arr.colors.length,colorsCounter==colPosition&&(colPosition=0),color=arr.colors[colPosition],colPosition++),"multi"==arr.type&&(color="none"),void 0==lbl&&(lbl=arr.lbl),out="<div class='graphField"+s.id+"' id='graphField"+unique+"' style='position: absolute'>",out+="<div class='graphValue"+s.id+"' id='graphValue"+unique+"'>"+prefix+value+postfix+"</div>",out+="<div class='graphBar"+s.id+"' id='graphFieldBar"+unique+"' style='background-color:"+color+";position: relative; overflow: hidden;'></div>",(!arr.legend||arr.legends)&&(out+="<div class='graphLabel"+s.id+"' id='graphLabel"+unique+"'>"+lbl+"</div>"),out+="</div>",e(s).append(out),totalHeightBar=totalHeight-e(".graphLabel"+s.id).height()-e(".graphValue"+s.id).height(),fieldHeight=totalHeightBar*value/max,e("#graphField"+unique).css({left:fieldWidth*l,width:fieldWidth-space,"margin-left":space}),valueData instanceof Array){"multi"==arr.type?(maxe=maxMulti(data),totalHeightBar=fieldHeight=totalHeight-e(".graphLabel"+s.id).height(),e(".graphValue"+s.id).remove()):maxe=max;for(i in valueData)heig=totalHeightBar*valueData[i]/maxe,wid=parseInt((fieldWidth-space)/valueData.length),sv="",fs=0,arr.showValues&&(sv=arr.prefix+valueData[i]+arr.postfix,fs=12),o="<div class='subBars"+s.id+"' style='height:"+heig+"px; background-color: "+arr.colors[i]+"; left:"+wid*i+"px; color:"+arr.showValuesColor+"; font-size:"+fs+"px' >"+sv+"</div>",e("#graphFieldBar"+unique).prepend(o)}"multi"==arr.type&&e(".subBars"+s.id).css({width:wid,position:"absolute",bottom:0}),"bottom"==arr.position&&e(".graphField"+s.id).css("bottom",0),arr.legends||r.push([color,lbl,s.id,unique]),arr.animate?(e("#graphFieldBar"+unique).css({height:0}),e("#graphFieldBar"+unique).animate({height:fieldHeight},1e3*arr.speed)):e("#graphFieldBar"+unique).css({height:fieldHeight})}for(var c in arr.legends)r.push([arr.colors[c],arr.legends[c],s.id,c]);createLegend(r),arr.legend&&(e(s).append("<div id='legendHolder"+unique+"'></div>"),e("#legendHolder"+unique).css({width:legendWidth,"float":"right","text-align":"left"}),e("#legendHolder"+unique).append(legend),e(".legendBar"+s.id).css({"float":"left",margin:3,height:12,width:20,"font-size":0})),arr.title&&(e(s).wrap("<div id='graphHolder"+unique+"'></div>"),e("#graphHolder"+unique).prepend(arr.title).css({width:arr.width+"px","text-align":"center"}))},createLegend=function(e){legend="";for(var t in e)legend+="<div id='legend"+e[t][3]+"' style='overflow: hidden; zoom: 1;'>",legend+="<div class='legendBar"+e[t][2]+"' id='legendColor"+e[t][3]+"' style='background-color:"+e[t][0]+"'></div>",legend+="<div class='legendLabel"+e[t][2]+"' id='graphLabel"+unique+"'>"+e[t][1]+"</div>",legend+="</div>"},this.each(function(){init(this)})},e.fn.jqBarGraph.defaults={barSpace:10,width:400,height:300,color:"#000000",colors:!1,lbl:"",sort:!1,position:"bottom",prefix:"",postfix:"",animate:!0,speed:1.5,legendWidth:100,legend:!1,legends:!1,type:!1,showValues:!0,showValuesColor:"#fff",title:!1}}(jQuery);