/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.0.9
 *
 */
!function(e){jQuery.fn.extend({slimScroll:function(t){var i={wheelStep:20,width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:"0.2",railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,scroll:0,touchScrollStep:200},n=e.extend(i,t);return this.each(function(){function i(e,t,i){var a=e,o=b.outerHeight()-k.outerHeight();if(t&&(a=parseInt(k.css("top"))+e*parseInt(n.wheelStep)/100*k.outerHeight(),a=Math.min(Math.max(a,0),o),a=e>0?Math.ceil(a):Math.floor(a),k.css({top:a+"px"})),p=parseInt(k.css("top"))/(b.outerHeight()-k.outerHeight()),a=p*(b[0].scrollHeight-b.outerHeight()),i){a=e;var l=a/b[0].scrollHeight*b.outerHeight();l=Math.min(Math.max(l,0),o),k.css({top:l+"px"})}b.scrollTop(a),s(),r()}function a(){d=Math.max(b.outerHeight()/b[0].scrollHeight*b.outerHeight(),g),k.css({height:d+"px"})}function s(){if(a(),clearTimeout(u),p==~~p&&(v=n.allowPageScroll,f!=p)){var e=0==~~p?"top":"bottom";b.trigger("slimscroll",e)}return f=p,d>=b.outerHeight()?void(v=!0):(k.stop(!0,!0).fadeIn("fast"),void(n.railVisible&&w.stop(!0,!0).fadeIn("fast")))}function r(){n.alwaysVisible||(u=setTimeout(function(){n.disableFadeOut&&o||l||c||(k.fadeOut("slow"),w.fadeOut("slow"))},1e3))}var o,l,c,u,h,d,p,f,m="<div></div>",g=30,v=!1,b=e(this);if(b.parent().hasClass("slimScrollDiv")){var _=b.scrollTop();if(k=b.parent().find(".slimScrollBar"),w=b.parent().find(".slimScrollRail"),a(),t){if("scrollTo"in t)_=parseInt(n.scrollTo);else if("scrollBy"in t)_+=parseInt(n.scrollBy);else if("destroy"in t)return k.remove(),w.remove(),void b.unwrap();i(_,!1,!0)}}else{n.height="auto"==n.height?b.parent().innerHeight():n.height;var y=e(m).addClass(n.wrapperClass).css({position:"relative",overflow:"hidden",width:n.width,height:n.height});b.css({overflow:"hidden",width:n.width,height:n.height});var w=e(m).addClass(n.railClass).css({width:n.size,height:"100%",position:"absolute",top:0,display:n.alwaysVisible&&n.railVisible?"block":"none","border-radius":n.size,background:n.railColor,opacity:n.railOpacity,zIndex:90}),k=e(m).addClass(n.barClass).css({background:n.color,width:n.size,position:"absolute",top:0,opacity:n.opacity,display:n.alwaysVisible?"block":"none","border-radius":n.size,BorderRadius:n.size,MozBorderRadius:n.size,WebkitBorderRadius:n.size,zIndex:99}),x="right"==n.position?{right:n.distance}:{left:n.distance};w.css(x),k.css(x),b.wrap(y),b.parent().append(k),b.parent().append(w),k.draggable({axis:"y",containment:"parent",start:function(){c=!0},stop:function(){c=!1,r()},drag:function(){i(0,e(this).position().top,!1)}}),w.hover(function(){s()},function(){r()}),k.hover(function(){l=!0},function(){l=!1}),b.hover(function(){o=!0,s(),r()},function(){o=!1,r()}),b.bind("touchstart",function(e){e.originalEvent.touches.length&&(h=e.originalEvent.touches[0].pageY)}),b.bind("touchmove",function(e){if(e.originalEvent.preventDefault(),e.originalEvent.touches.length){var t=(h-e.originalEvent.touches[0].pageY)/n.touchScrollStep;i(t,!0)}});var C=function(t){if(o){var t=t||window.event,a=0;t.wheelDelta&&(a=-t.wheelDelta/120),t.detail&&(a=t.detail/3);var s=t.target||t.srcTarget;e(s).closest("."+n.wrapperClass).is(b.parent())&&i(a,!0),t.preventDefault&&!v&&t.preventDefault(),v||(t.returnValue=!1)}},S=function(){window.addEventListener?(this.addEventListener("DOMMouseScroll",C,!1),this.addEventListener("mousewheel",C,!1)):document.attachEvent("onmousewheel",C)};S(),a(),"bottom"==n.start?(k.css({top:b.outerHeight()-k.outerHeight()}),i(0,!0)):"object"==typeof n.start&&(i(e(n.start).position().top,null,!0),n.alwaysVisible||k.hide())}}),this}}),jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})}(jQuery);