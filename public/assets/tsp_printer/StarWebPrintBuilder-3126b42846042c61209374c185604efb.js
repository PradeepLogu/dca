// Copyright (C) 2012-2013 STAR MICRONICS CO., LTD. All Rights Reserved.
var StarWebPrintBuilder=function(){};StarWebPrintBuilder.prototype.createAlignmentElement=function(e){var t="<alignment";return void 0!=e&&(t+=this._analysisEnumAttribute("position",e.position,/^(left|center|right)$/)),t+"/>"},StarWebPrintBuilder.prototype.createBarcodeElement=function(e){var t;if(void 0==e)throw Error("Argument is undefined.");if(t="<barcode"+this._analysisEnumAttribute("symbology",e.symbology,/^(UPCE|UPCA|JAN8|JAN13|Code39|ITF|Code128|Code93|NW7)$/),t+=this._analysisEnumAttribute("width",e.width,/^(width[2-4]|width_mode[1-9])$/),t+=this._analysisEnumAttribute("hri",e.hri,/^(false|true)$/),t+=this._analysisValueAttribute("height",e.height,1,255),void 0==e.data)throw Error('Argument "data" is undefined.');return t=t+">"+this._encodeEscapeSequenceBinary(e.data),t+="</barcode>"},StarWebPrintBuilder.prototype.createBitImageElement=function(e){var t="<bitimage";if(void 0==e)throw Error("Argument is undefined.");var i=0,n=0,a=0,s=0;if(void 0!=e.x&&(i=e.x),void 0!=e.y&&(n=e.y),void 0!=e.width&&(a=e.width),void 0!=e.height&&(s=e.height),this._analysisValueAttribute("x",i,0,65535),this._analysisValueAttribute("y",n,0,65535),t+=this._analysisValueAttribute("width",a,0,65535),t+=this._analysisValueAttribute("height",s,0,65535),void 0==e.context)throw Error('Argument "context" is undefined.');return t=t+">"+this._encodeRasterImage(e.context.getImageData(i,n,a,s).data,a,s),t+="</bitimage>"},StarWebPrintBuilder.prototype.createCutPaperElement=function(e){var t="<cutpaper";return void 0!=e&&(t+=this._analysisEnumAttribute("feed",e.feed,/^(false|true)$/),t+=this._analysisEnumAttribute("type",e.type,/^(full|partial)$/)),t+"/>"},StarWebPrintBuilder.prototype.createFeedElement=function(e){var t;if(void 0==e)throw Error("Argument is undefined.");if(void 0==e.line&&void 0==e.unit)throw Error('Argument "line / unit" is undefined.');return t="<feed"+this._analysisValueAttribute("line",e.line,1,255),t+=this._analysisValueAttribute("unit",e.unit,1,255),t+"/>"},StarWebPrintBuilder.prototype.createInitializationElement=function(e){var t="<initialization";return void 0!=e&&(t+=this._analysisEnumAttribute("reset",e.reset,/^(false|true)$/),t+=this._analysisEnumAttribute("print",e.print,/^(false|true)$/)),t+"/>"},StarWebPrintBuilder.prototype.createLogoElement=function(e){var t="<logo";return void 0!=e&&(t+=this._analysisEnumAttribute("width",e.width,/^(single|double)$/),t+=this._analysisEnumAttribute("height",e.height,/^(single|double)$/),t+=this._analysisValueAttribute("number",e.number,1,255)),t+"/>"},StarWebPrintBuilder.prototype.createPdf417Element=function(e){var t;if(void 0==e)throw Error("Argument is undefined.");if(t="<pdf417"+this._analysisEnumAttribute("level",e.level,/^(level[0-8])$/),void 0!=e.line&&(t=0!=e.line?t+this._analysisValueAttribute("line",e.line,3,90):t+' line="0"'),t+=this._analysisValueAttribute("column",e.column,0,30),t+=this._analysisValueAttribute("module",e.module,1,8),t+=this._analysisValueAttribute("aspect",e.aspect,1,8),void 0==e.data)throw Error('Argument "data" is undefined.');return t=t+">"+this._encodeEscapeSequenceBinary(e.data),t+="</pdf417>"},StarWebPrintBuilder.prototype.createPeripheralElement=function(e){var t="<peripheral";return void 0!=e&&(t+=this._analysisValueAttribute("channel",e.channel,1,2),t+=this._analysisValueAttribute("on",e.on,1,65535),t+=this._analysisValueAttribute("off",e.off,1,65535)),t+"/>"},StarWebPrintBuilder.prototype.createQrCodeElement=function(e){var t;if(void 0==e)throw Error("Argument is undefined.");if(t="<qrcode"+this._analysisEnumAttribute("model",e.model,/^(model[12])$/),t+=this._analysisEnumAttribute("level",e.level,/^(level_[lmqh])$/),t+=this._analysisValueAttribute("cell",e.cell,1,8),void 0==e.data)throw Error('Argument "data" is undefined.');return t=t+">"+this._encodeEscapeSequenceBinary(e.data),t+="</qrcode>"},StarWebPrintBuilder.prototype.createRawDataElement=function(e){if(void 0==e)throw Error("Argument is undefined.");if(void 0==e.data)throw Error('Argument "data" is undefined.');return e="<rawdata>"+this._encodeBase64Binary(e.data),e+"</rawdata>"},StarWebPrintBuilder.prototype.createRuledLineElement=function(e){var t="<ruledline";return void 0!=e&&(t+=this._analysisEnumAttribute("thickness",e.thickness,/^(thin|medium|thick|double_(thin|medium|thick))$/),t+=this._analysisValueAttribute("width",e.width,1,65535)),t+"/>"},StarWebPrintBuilder.prototype.createSoundElement=function(e){var t="<sound";return void 0!=e&&(t+=this._analysisValueAttribute("channel",e.channel,1,2),t+=this._analysisValueAttribute("repeat",e.repeat,1,20)),t+"/>"},StarWebPrintBuilder.prototype.createTextElement=function(e){var t;if(void 0==e)throw Error("Argument is undefined.");return t="<text"+this._analysisEnumAttribute("emphasis",e.emphasis,/^(false|true)$/),t+=this._analysisEnumAttribute("invert",e.invert,/^(false|true)$/),t+=this._analysisEnumAttribute("linespace",e.linespace,/^(24|32)$/),t+=this._analysisEnumAttribute("font",e.font,/^(font_[ab])$/),t+=this._analysisEnumAttribute("underline",e.underline,/^(false|true)$/),t+=this._analysisValueAttribute("characterspace",e.characterspace,0,7),t+=this._analysisValueAttribute("width",e.width,1,6),t+=this._analysisValueAttribute("height",e.height,1,6),t+=this._analysisEnumAttribute("codepage",e.codepage,/^(cp(437|737|772|774|851|852|855|857|858|860|861|862|863|864|865|866|869|874|928|932|998|999|1001|1250|1251|1252|2001|3001|3002|3011|3012|3021|3041|3840|3841|3843|3844|3845|3846|3847|3848)|utf8|blank)$/),t+=this._analysisEnumAttribute("international",e.international,/^(usa|france|germany|uk|denmark|sweden|italy|spain|japan|norway|denmark2|spain2|latin_america|korea|ireland|legal)$/),void 0!=e.data?(t+=">",t=1==e.binary?t+this._encodeEscapeSequenceBinary(e.data):t+this._encodeEscapeSequence(e.data),t+="</text>"):t+="/>",t},StarWebPrintBuilder.prototype._analysisEnumAttribute=function(e,t,i){if(void 0!=t){if(!i.test(t))throw Error('Argument "'+e+'" is invalid.');return" "+e+'="'+t+'"'}return""},StarWebPrintBuilder.prototype._analysisValueAttribute=function(e,t,i,n){if(void 0!=t){if(i>t||t>n)throw Error('Argument "'+e+'" is invalid.');return" "+e+'="'+t+'"'}return""},StarWebPrintBuilder.prototype._encodeEscapeSequence=function(e){var t=/[\\\x00-\x20\x26\x3c\x3e\x7f]/g;return t.test(e)&&(e=e.replace(t,function(e){return"\\"==e?"\\\\":"\\x"+("0"+e.charCodeAt(0).toString(16)).slice(-2)})),e},StarWebPrintBuilder.prototype._encodeEscapeSequenceBinary=function(e){var t=/[\\\x00-\x20\x26\x3c\x3e\x7f-\xff]/g;return t.test(e)&&(e=e.replace(t,function(e){return"\\"==e?"\\\\":"\\x"+("0"+e.charCodeAt(0).toString(16)).slice(-2)})),e},StarWebPrintBuilder.prototype._encodeBase64Binary=function(e){var t="",i=e.length;e+="\x00\x00";for(var n=0;i>n;n+=3)var a=e.charCodeAt(n)<<16|e.charCodeAt(n+1)<<8|e.charCodeAt(n+2),t=t+("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>18&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&a));switch(i%3){case 1:return t.slice(0,-2)+"==";case 2:return t.slice(0,-1)+"="}return t},StarWebPrintBuilder.prototype._encodeRasterImage=function(e,t,i){for(var n=[[-254,-126,-222,-94,-246,-118,-214,-86],[-62,-190,-30,-158,-54,-182,-22,-150],[-206,-78,-238,-110,-198,-70,-230,-102],[-14,-142,-46,-174,-6,-134,-38,-166],[-242,-114,-210,-82,-250,-122,-218,-90],[-50,-178,-18,-146,-58,-186,-26,-154],[-194,-66,-226,-98,-202,-74,-234,-106],[-2,-130,-34,-162,-10,-138,-42,-170]],a="",s=0,r=0;i>r;r++){for(var o=0,l=128,c=0;t>c;c++)((30*e[s]+59*e[s+1]+11*e[s+2])*e[s+3]+12800)/25500-e[s+3]<n[7&r][7&c]&&(o|=l),s+=4,0==(l>>=1)&&(a+=String.fromCharCode(o),o=0,l=128);128!=l&&(a+=String.fromCharCode(o))}for(e=a,a="",t=e.length,e+="\x00\x00",r=0;t>r;r+=3)i=e.charCodeAt(r)<<16|e.charCodeAt(r+1)<<8|e.charCodeAt(r+2),a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>18&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>12&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>6&63)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&i);switch(t%3){case 1:return a.slice(0,-2)+"==";case 2:return a.slice(0,-1)+"="}return a};